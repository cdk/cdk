<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_21) on Sun Apr 27 11:16:00 BST 2014 -->
<meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
<title>Canon (cdk 1.5.6 API)</title>
<meta name="date" content="2014-04-27">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Canon (cdk 1.5.6 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Canon.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../../org/openscience/cdk/graph/invariant/CanonicalLabeler.html" title="class in org.openscience.cdk.graph.invariant"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/openscience/cdk/graph/invariant/Canon.html" target="_top">Frames</a></li>
<li><a href="Canon.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.openscience.cdk.graph.invariant</div>
<h2 title="Class Canon" class="title">Class Canon</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.openscience.cdk.graph.invariant.Canon</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public final class <span class="strong">Canon</span>
extends <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block">An implementation based on the canon algorithm [<!-- indexOf-1 -->Weininger, David and Weininger, Arthur and Weininger, Joseph
        L., <i>SMILES 2. Algorithm for Generation of Unique SMILES
          Notation</i>, Journal of Chemical Information and Computer
          Sciences, <b>1989</b>, 29:97-101]. The 
 algorithm uses an initial set of of invariants which are assigned a rank.
 Equivalent ranks are then shattered using an unambiguous function (in this
 case, the product of primes of adjacent ranks). Once no more equivalent ranks
 can be shattered ties are artificially broken and rank shattering continues.
 Unlike the original description rank stability is not maintained reducing
 the number of values to rank at each stage to only those which are equivalent.
 <p/>    
 
 The initial set of invariants is basic and are - <i> 
 "sufficient for the purpose of obtaining unique notation for simple SMILES,
  but it is not necessarily a “complete” set. No “perfect” set of invariants
  is known that will distinguish all possible graph asymmetries. However, 
  for any given set of structures, a set of invariants can be devised to 
  provide the necessary discrimination"</i> [<!-- indexOf-1 -->Weininger, David and Weininger, Arthur and Weininger, Joseph
        L., <i>SMILES 2. Algorithm for Generation of Unique SMILES
          Notation</i>, Journal of Chemical Information and Computer
          Sciences, <b>1989</b>, 29:97-101]. As such this
  producer should not be considered a complete canonical labelledr but in
  practice performs well. For a more accurate and computationally expensive
  labelling, please using the <a href="../../../../../org/openscience/cdk/graph/invariant/InChINumbersTools.html" title="class in org.openscience.cdk.graph.invariant"><code>InChINumbersTools</code></a>.
  
 <blockquote><pre>
 IAtomContainer m = ...;
 int[][]        g = GraphUtil.toAdjList(m);
 
 // obtain canon labelling
 long[] labels = Canon.label(m, g);
 
 // obtain symmetry classes
 long[] labels = Canon.symmetry(m, g);
 </pre></blockquote></div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>John May</dd>
<DT><B>Source code: </B><DD><a href="https://github.com/cdk/cdk/tree/master/src/main/java/org/openscience/cdk/graph/invariant/Canon.java" target="_blank">master</a></DD>
<DT><B>Belongs to CDK module: </B><DD>standard</DD></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static long[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/openscience/cdk/graph/invariant/Canon.html#basicInvariants(org.openscience.cdk.interfaces.IAtomContainer, int[][])">basicInvariants</a></strong>(<a href="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</a>&nbsp;container,
               int[][]&nbsp;graph)</code>
<div class="block">Generate the initial invariants for each atom in the <code>container</code>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static long[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/openscience/cdk/graph/invariant/Canon.html#label(org.openscience.cdk.interfaces.IAtomContainer, int[][])">label</a></strong>(<a href="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</a>&nbsp;container,
     int[][]&nbsp;g)</code>
<div class="block">Compute the canonical labels for the provided structure.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static long[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/openscience/cdk/graph/invariant/Canon.html#label(org.openscience.cdk.interfaces.IAtomContainer, int[][], long[])">label</a></strong>(<a href="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</a>&nbsp;container,
     int[][]&nbsp;g,
     long[]&nbsp;invariants)</code>
<div class="block">Compute the canonical labels for the provided structure.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static long[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/openscience/cdk/graph/invariant/Canon.html#symmetry(org.openscience.cdk.interfaces.IAtomContainer, int[][])">symmetry</a></strong>(<a href="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</a>&nbsp;container,
        int[][]&nbsp;g)</code>
<div class="block">Compute the symmetry classes for the provided structure.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="label(org.openscience.cdk.interfaces.IAtomContainer, int[][])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>label</h4>
<pre>public static&nbsp;long[]&nbsp;label(<a href="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</a>&nbsp;container,
           int[][]&nbsp;g)</pre>
<div class="block">Compute the canonical labels for the provided structure. The labelling
 does not consider isomer information or stereochemistry. The current 
 implementation does not fully distinguish all structure topologies
 but in practise performs well in the majority of cases. A complete 
 canonical labelling can be obtained using the <a href="../../../../../org/openscience/cdk/graph/invariant/InChINumbersTools.html" title="class in org.openscience.cdk.graph.invariant"><code>InChINumbersTools</code></a>
 but is computationally much more expensive.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>container</code> - structure</dd><dd><code>g</code> - adjacency list graph representation</dd>
<dt><span class="strong">Returns:</span></dt><dd>the canonical labelling</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../org/openscience/cdk/graph/invariant/EquivalentClassPartitioner.html" title="class in org.openscience.cdk.graph.invariant"><code>EquivalentClassPartitioner</code></a>, 
<a href="../../../../../org/openscience/cdk/graph/invariant/InChINumbersTools.html" title="class in org.openscience.cdk.graph.invariant"><code>InChINumbersTools</code></a></dd></dl>
</li>
</ul>
<a name="label(org.openscience.cdk.interfaces.IAtomContainer, int[][], long[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>label</h4>
<pre>public static&nbsp;long[]&nbsp;label(<a href="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</a>&nbsp;container,
           int[][]&nbsp;g,
           long[]&nbsp;invariants)</pre>
<div class="block">Compute the canonical labels for the provided structure. The labelling
 does not consider isomer information or stereochemistry. This method
 allows provision of a custom array of initial invariants.
 
 <p/>
 The current 
 implementation does not fully distinguish all structure topologies
 but in practise performs well in the majority of cases. A complete 
 canonical labelling can be obtained using the <a href="../../../../../org/openscience/cdk/graph/invariant/InChINumbersTools.html" title="class in org.openscience.cdk.graph.invariant"><code>InChINumbersTools</code></a>
 but is computationally much more expensive.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>container</code> - structure</dd><dd><code>g</code> - adjacency list graph representation</dd><dd><code>invariants</code> - intial invariants</dd>
<dt><span class="strong">Returns:</span></dt><dd>the canonical labelling</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../org/openscience/cdk/graph/invariant/EquivalentClassPartitioner.html" title="class in org.openscience.cdk.graph.invariant"><code>EquivalentClassPartitioner</code></a>, 
<a href="../../../../../org/openscience/cdk/graph/invariant/InChINumbersTools.html" title="class in org.openscience.cdk.graph.invariant"><code>InChINumbersTools</code></a></dd></dl>
</li>
</ul>
<a name="symmetry(org.openscience.cdk.interfaces.IAtomContainer, int[][])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>symmetry</h4>
<pre>public static&nbsp;long[]&nbsp;symmetry(<a href="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</a>&nbsp;container,
              int[][]&nbsp;g)</pre>
<div class="block">Compute the symmetry classes for the provided structure. There are known
 examples where symmetry is incorrectly found. The <a href="../../../../../org/openscience/cdk/graph/invariant/EquivalentClassPartitioner.html" title="class in org.openscience.cdk.graph.invariant"><code>EquivalentClassPartitioner</code></a> gives more accurate symmetry perception but
 this method is very quick and in practise successfully portions the 
 majority of chemical structures.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>container</code> - structure</dd><dd><code>g</code> - adjacency list graph representation</dd>
<dt><span class="strong">Returns:</span></dt><dd>symmetry classes</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../org/openscience/cdk/graph/invariant/EquivalentClassPartitioner.html" title="class in org.openscience.cdk.graph.invariant"><code>EquivalentClassPartitioner</code></a></dd></dl>
</li>
</ul>
<a name="basicInvariants(org.openscience.cdk.interfaces.IAtomContainer, int[][])">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>basicInvariants</h4>
<pre>public static&nbsp;long[]&nbsp;basicInvariants(<a href="../../../../../org/openscience/cdk/interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</a>&nbsp;container,
                     int[][]&nbsp;graph)</pre>
<div class="block">Generate the initial invariants for each atom in the <code>container</code>.
 The labels use the invariants described in [<!-- indexOf-1 -->Weininger, David and Weininger, Arthur and Weininger, Joseph
        L., <i>SMILES 2. Algorithm for Generation of Unique SMILES
          Notation</i>, Journal of Chemical Information and Computer
          Sciences, <b>1989</b>, 29:97-101]. <p/> 
 
 The bits in the low 32-bits are: <code>0000000000xxxxXXXXeeeeeeescchhhh</code>
 where:
 <ul>
     <li>0: padding</li>
     <li>x: number of connections</li>
     <li>X: number of non-hydrogens bonds</li>
     <li>e: atomic number</li>
     <li>s: sign of charge</li>
     <li>c: absolute charge</li>
     <li>h: number of attached hydrogens</li>
 </ul>

 <b>Important: These invariants are <i>basic</i> and there are known
 examples they don't distinguish. One trivial example to consider is 
 <code>[O]C=O</code> where both oxygens have no hydrogens and a single 
 connection but the atoms are not equivalent. Including a better 
 initial partition is more expensive</b></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>container</code> - an atom container to generate labels for</dd><dd><code>graph</code> - graph representation (adjacency list)</dd>
<dt><span class="strong">Returns:</span></dt><dd>initial invariants</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/6/docs/api/java/lang/NullPointerException.html?is-external=true" title="class or interface in java.lang">NullPointerException</a></code> - an atom had unset atomic number, hydrogen
                              count or formal charge</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Canon.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../../org/openscience/cdk/graph/invariant/CanonicalLabeler.html" title="class in org.openscience.cdk.graph.invariant"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/openscience/cdk/graph/invariant/Canon.html" target="_top">Frames</a></li>
<li><a href="Canon.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2014. All Rights Reserved.</small></p>
</body>
</html>
