<project name="JCPCDK" default="dist-jcp" basedir=".">
    <import file="build.xml"/>

    <property name="plugin.dir" value="pluginjar" />


    <target id="dist-jcp" name="dist-jcp" depends="dist-all, compile-jcp, unjar-libjars, unjar-cdkjars"
            description="Builds the JChemPaint application">
        <jar jarfile="${dist}/jar/jchempaint-${jcp.version}.jar">
            <manifest>
                <attribute name="Main-Class" value="org.openscience.cdk.applications.jchempaint.application.JChemPaint"/>
                <section name="org/openscience/cdk/applications/jchempaint/">
                    <attribute name="Specification-Title" value="JChemPaint"/>
                    <attribute name="Specification-Version" value="2.2"/>
                    <attribute name="Specification-Vendor" value="The CDK Project"/>
                    <attribute name="Implementation-Title" value="org.openscience.cdk.applications.jchempaint"/>
                    <attribute name="Implementation-Version" value="${jcp.version}"/>
                    <attribute name="Implementation-Vendor" value="The CDK Project"/>
                </section>
            </manifest>
            <fileset dir="${appjars.dir}">
                <include name="**/*" />
            </fileset>
            <fileset dir="${src}">
                <includesfile name="${metainf}/jchempaint.application.datafiles"/>
            </fileset>
        </jar>
    </target>

    <target id="jcp-only" name="jcp-only"
            description="Builds the JChemPaint application">
        <antcall target="compile-module">
            <param name="module" value="jchempaint"/>
        </antcall>
        <antcall target="compile-module">
            <param name="module" value="jchempaint.application"/>
        </antcall>
        <antcall target="compile-module">
            <param name="module" value="jchempaint.applet"/>
        </antcall>
        <unjar dest="${appjars.dir}">
            <fileset dir="${dist}/jar">
                <include name="cdk-jchempaint.jar"/>
                <include name="cdk-jchempaint.application.jar"/>
                <include name="cdk-jchempaint.applet.jar"/>
            </fileset>
        </unjar>
            
            <!-- then zip up things -->
        <jar jarfile="${dist}/jar/jchempaint-${jcp.version}.jar">
            <manifest>
                <attribute name="Main-Class" value="org.openscience.cdk.applications.jchempaint.application.JChemPaint"/>
                <section name="org/openscience/cdk/applications/jchempaint/">
                    <attribute name="Specification-Title" value="JChemPaint"/>
                    <attribute name="Specification-Version" value="1.0"/>
                    <attribute name="Specification-Vendor" value="The CDK Project"/>
                    <attribute name="Implementation-Title" value="org.openscience.cdk"/>
                    <attribute name="Implementation-Version" value="${jcp.version}"/>
                    <attribute name="Implementation-Vendor" value="The CDK Project"/>
                </section>
            </manifest>
            <fileset dir="${appjars.dir}">
                <include name="**/*" />
            </fileset>
            <fileset dir="${src}">
                <includesfile name="${metainf}/jchempaint.application.datafiles"/>
            </fileset>
        </jar>
    </target>
	
    <target id="unjar" name="unjar" description="unjars a lot">
        <unjar dest="${appjars.dir}">
            <fileset dir="${lib}">
                <includesfile name="${metainf}/applications.libdepends"/>
                <includesfile name="${metainf}/core.libdepends"/>
                <includesfile name="${metainf}/data.libdepends"/>
                <includesfile name="${metainf}/experimental.libdepends"/>
                <includesfile name="${metainf}/extra.libdepends"/>
                <includesfile name="${metainf}/io.libdepends"/>
                <includesfile name="${metainf}/libio-cml.libdepends"/>
                <includesfile name="${metainf}/qsar.libdepends"/>
                <includesfile name="${metainf}/render.libdepends"/>
                <includesfile name="${metainf}/standard.libdepends"/>
                <includesfile name="${metainf}/svg.libdepends"/>
                <includesfile name="${metainf}/sdg.libdepends"/>
                <includesfile name="${metainf}/control.libdepends"/>
                <includesfile name="${metainf}/jchempaint.libdepends"/>
            </fileset>
        </unjar>
    </target>

    <target id="unjar-libjars" name="unjar-libjars">
        <unjar dest="${appjars.dir}">
            <fileset dir="${lib}">
                <includesfile name="${metainf}/applications.libdepends"/>
                <includesfile name="${metainf}/core.libdepends"/>
                <includesfile name="${metainf}/data.libdepends"/>
                <includesfile name="${metainf}/experimental.libdepends"/>
                <includesfile name="${metainf}/extra.libdepends"/>
                <includesfile name="${metainf}/io.libdepends"/>
                <includesfile name="${metainf}/libio-cml.libdepends"/>
                <includesfile name="${metainf}/qsar.libdepends"/>
                <includesfile name="${metainf}/render.libdepends"/>
                <includesfile name="${metainf}/standard.libdepends"/>
                <includesfile name="${metainf}/svg.libdepends"/>
                <includesfile name="${metainf}/jchempaint.libdepends"/>
            </fileset>
	 </unjar>
	 </target>

    <target id="unjar-cdkjars" name="unjar-cdkjars">
	 <unjar dest="${appjars.dir}">
            <fileset dir="${plugin.dir}">
                <include name="dirbrowser.jar"/>
                <include name="dadmlbrowser.jar"/>
                <include name="aminoacidtemplates.jar"/>
            </fileset>
            <fileset dir="${dist}/jar">
                <include name="cdk-applications.jar"/>
                <include name="cdk-core.jar"/>
                <include name="cdk-data.jar"/>
                <include name="cdk-experimental.jar"/>
                <include name="cdk-extra.jar"/>
                <include name="cdk-interfaces.jar"/>
                <include name="cdk-io.jar"/>
                <include name="cdk-libio-cml.jar"/>
                <include name="cdk-qsar.jar"/>
                <include name="cdk-render.jar"/>
                <include name="cdk-standard.jar"/>
                <include name="cdk-svg.jar"/>
                <include name="cdk-jchempaint.jar"/>
                <include name="cdk-jchempaint.application.jar"/>
                <include name="cdk-jchempaint.applet.jar"/>
                <include name="cdk-nonotify.jar"/>
		<include name="cdk-valencycheck.jar"/>
		<include name="cdk-smiles.jar"/>
                <include name="cdk-sdg.jar"/>
                <include name="cdk-control.jar"/>
            </fileset>
        </unjar>
    </target>

    <target id="compile-jcp" name="compile-jcp">
        <antcall target="compile-module">
            <param name="module" value="jchempaint"/>
        </antcall>
        <antcall target="compile-module">
            <param name="module" value="jchempaint.application"/>
        </antcall>
        <antcall target="compile-module">
            <param name="module" value="jchempaint.applet"/>
        </antcall>
    </target>
    
    
</project>



