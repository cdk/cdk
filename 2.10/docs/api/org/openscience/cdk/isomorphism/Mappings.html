<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.19) on Thu Jan 09 19:39:26 GMT 2025 -->
<title>Mappings (cdk 2.10 API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2025-01-09">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../jquery/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-ui.min.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="Mappings (cdk 2.10 API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":42,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10,"i19":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"],32:["t6","Deprecated Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Mappings.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.openscience.cdk.isomorphism</a></div>
<h2 title="Class Mappings" class="title">Class Mappings</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.openscience.cdk.isomorphism.Mappings</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;int[]&gt;</code></dd>
</dl>
<hr>
<pre>public final class <span class="typeNameLabel">Mappings</span>
extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>
implements <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;int[]&gt;</pre>
<div class="block">A fluent interface for handling (sub)-graph mappings from a query to a target
 structure. The utility allows one to modify the mappings and provides
 convenience utilities. <a href="Mappings.html" title="class in org.openscience.cdk.isomorphism"><code>Mappings</code></a> are obtained from a (sub)-graph
 matching using <a href="Pattern.html" title="class in org.openscience.cdk.isomorphism"><code>Pattern</code></a>.

 <blockquote><pre>
 IAtomContainer query  = ...;
 IAtomContainer target = ...;

 Mappings mappings = Pattern.findSubstructure(query)
                            .matchAll(target);
 </pre></blockquote>

 The primary function is to provide an iterable of matches - each match is
 a permutation (mapping) of the query graph indices (atom indices).

 <blockquote><pre><code>
 for (int[] p : mappings) {
     for (int i = 0; i &lt; p.length; i++)
         // query.getAtom(i) is mapped to target.getAtom(p[i]);
 }
 </code></pre></blockquote>

 The matches can be filtered to provide only those that have valid
 stereochemistry.

 <blockquote><pre>
 for (int[] p : mappings.stereochemistry()) {
     // ...
 }
 </pre></blockquote>

 Unique matches can be obtained for both atoms and bonds.

 <blockquote><pre>
 for (int[] p : mappings.uniqueAtoms()) {
     // ...
 }

 for (int[] p : mappings.uniqueBonds()) {
     // ...
 }
 </pre></blockquote>

 As matches may be lazily generated - iterating over the match twice (as
 above) will actually perform two graph matchings. If the mappings are needed
 for subsequent use the <a href="#toArray()"><code>toArray()</code></a> provides the permutations as a
 fixed size array.

 <blockquote><pre>
 int[][] ps = mappings.toArray();
 for (int[] p : ps) {
    // ...
 }
 </pre></blockquote>

 Graphs with a high number of automorphisms can produce many valid matchings.
 Operations can be combined such as to limit the number of matches we
 retrieve.

 <blockquote><pre>
 // first ten matches
 for (int[] p : mappings.limit(10)) {
     // ...
 }

 // first 10 unique matches
 for (int[] p : mappings.uniqueAtoms()
                        .limit(10)) {
     // ...
 }

 // ensure we don't waste memory and only 'fix' up to 100 unique matches
 int[][] ps = mappings.uniqueAtoms()
                      .limit(100)
                      .toArray();
 </pre></blockquote>

 There is no restrictions on which operation can be applied and how many times
 but the order of operations may change the result.

 <blockquote><pre>
 // first 100 unique matches
 Mappings m = mappings.uniqueAtoms()
                      .limit(100);

 // unique matches in the first 100 matches
 Mappings m = mappings.limit(100)
                      .uniqueAtoms();

 // first 10 unique matches in the first 100 matches
 Mappings m = mappings.limit(100)
                      .uniqueAtoms()
                      .limit(10);

 // number of unique atom matches
 int n = mappings.countUnique();

 // number of unique atom matches with correct stereochemistry
 int n = mappings.stereochemistry()
                 .countUnique();

 </pre></blockquote></div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>John May</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="Pattern.html" title="class in org.openscience.cdk.isomorphism"><code>Pattern</code></a></dd>
<DT><B>Source code: </B><DD><a href="https://github.com/cdk/cdk/tree/main/base/isomorphism/src/main/java/org/openscience/cdk/isomorphism/Mappings.java" target="_blank">main</a></DD>
<DT><B>Belongs to CDK module: </B><DD>isomorphism</DD>
<dt><span class="simpleTagLabel">Keywords:</span></dt>
<dd>substructure search, structure search, mappings, matching</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t6" class="tableTab"><span><a href="javascript:show(32);">Deprecated Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#atLeast(int)">atLeast</a></span>&#8203;(int&nbsp;n)</code></th>
<td class="colLast">
<div class="block">Efficiently determine if there are at least 'n' matches

 </div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#count()">count</a></span>()</code></th>
<td class="colLast">
<div class="block">Convenience method to count the number mappings.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#countUnique()">countUnique</a></span>()</code></th>
<td class="colLast">
<div class="block">Convenience method to count the number of unique atom mappings.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#exclusiveAtoms()">exclusiveAtoms</a></span>()</code></th>
<td class="colLast">
<div class="block">Filter the mappings for those which cover an exclusive set of atoms in
 the target.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code><a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#filter(java.util.function.Predicate)">filter</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Predicate.html?is-external=true" title="class or interface in java.util.function" class="externalLink">Predicate</a>&lt;int[]&gt;&nbsp;predicate)</code></th>
<td class="colLast">
<div class="block">Filter the mappings and keep only those which match the provided
 predicate (Guava).</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>int[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#first()">first</a></span>()</code></th>
<td class="colLast">
<div class="block">Obtain the first match - if there is no first match an empty array is
 returned.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/util/Iterator.html?is-external=true" title="class or interface in java.util" class="externalLink">Iterator</a>&lt;int[]&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#iterator()">iterator</a></span>()</code></th>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code><a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#limit(int)">limit</a></span>&#8203;(int&nbsp;limit)</code></th>
<td class="colLast">
<div class="block">Limit the number of mappings - only this number of mappings will be
 generate.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;T&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#map(java.util.function.Function)">map</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Function.html?is-external=true" title="class or interface in java.util.function" class="externalLink">Function</a>&lt;int[],&#8203;T&gt;&nbsp;f)</code></th>
<td class="colLast">
<div class="block">Map the mappings to another type.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code><a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#stereochemistry()">stereochemistry</a></span>()</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Results now automatically consider stereo if it's present, to
             match without stereochemistry remove the stereo features.</div>
</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html?is-external=true" title="class or interface in java.util.stream" class="externalLink">Stream</a>&lt;int[]&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#stream()">stream</a></span>()</code></th>
<td class="colLast">
<div class="block">Convert the Mappings to a Java 8 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html?is-external=true" title="class or interface in java.util.stream" class="externalLink"><code>Stream</code></a>.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>int[][]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#toArray()">toArray</a></span>()</code></th>
<td class="colLast">
<div class="block">Mappings are lazily generated and best used in a loop.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util" class="externalLink">Map</a>&lt;<a href="../interfaces/IChemObject.html" title="interface in org.openscience.cdk.interfaces">IChemObject</a>,&#8203;<a href="../interfaces/IChemObject.html" title="interface in org.openscience.cdk.interfaces">IChemObject</a>&gt;&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#toAtomBondMap()">toAtomBondMap</a></span>()</code></th>
<td class="colLast">
<div class="block">Convert the permutations to an atom-atom bond-bond map.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util" class="externalLink">Map</a>&lt;<a href="../interfaces/IAtom.html" title="interface in org.openscience.cdk.interfaces">IAtom</a>,&#8203;<a href="../interfaces/IAtom.html" title="interface in org.openscience.cdk.interfaces">IAtom</a>&gt;&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#toAtomMap()">toAtomMap</a></span>()</code></th>
<td class="colLast">
<div class="block">Convert the permutations to a atom-atom map.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util" class="externalLink">Map</a>&lt;<a href="../interfaces/IBond.html" title="interface in org.openscience.cdk.interfaces">IBond</a>,&#8203;<a href="../interfaces/IBond.html" title="interface in org.openscience.cdk.interfaces">IBond</a>&gt;&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#toBondMap()">toBondMap</a></span>()</code></th>
<td class="colLast">
<div class="block">Convert the permutations to a bond-bond map.</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;<a href="../interfaces/IChemObject.html" title="interface in org.openscience.cdk.interfaces">IChemObject</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#toChemObjects()">toChemObjects</a></span>()</code></th>
<td class="colLast">
<div class="block">Obtain the chem objects (atoms and bonds) that have 'hit' in the target molecule.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;<a href="../interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#toSubstructures()">toSubstructures</a></span>()</code></th>
<td class="colLast">
<div class="block">Obtain the mapped substructures (atoms/bonds) of the target compound.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html?is-external=true" title="class or interface in java.util.stream" class="externalLink">Stream</a>&lt;<a href="../interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#toSubstructuresStream()">toSubstructuresStream</a></span>()</code></th>
<td class="colLast">
<div class="block">Obtain the mapped substructures (atoms/bonds) of the target compound.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code><a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#uniqueAtoms()">uniqueAtoms</a></span>()</code></th>
<td class="colLast">
<div class="block">Filter the mappings for those which cover a unique atoms in the
 target.</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code><a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#uniqueBonds()">uniqueBonds</a></span>()</code></th>
<td class="colLast">
<div class="block">Filter the mappings for those which cover a unique set of bonds in the
 target.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang" class="externalLink">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang" class="externalLink">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang" class="externalLink">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang" class="externalLink">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang" class="externalLink">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang" class="externalLink">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang" class="externalLink">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang" class="externalLink">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait(long,int)" title="class or interface in java.lang" class="externalLink">wait</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Iterable">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true#forEach(java.util.function.Consumer)" title="class or interface in java.lang" class="externalLink">forEach</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true#spliterator()" title="class or interface in java.lang" class="externalLink">spliterator</a></code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="filter(java.util.function.Predicate)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>filter</h4>
<pre class="methodSignature">public&nbsp;<a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a>&nbsp;filter&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Predicate.html?is-external=true" title="class or interface in java.util.function" class="externalLink">Predicate</a>&lt;int[]&gt;&nbsp;predicate)</pre>
<div class="block">Filter the mappings and keep only those which match the provided
 predicate (Guava).

 <blockquote><pre><code>

     final IAtomContainer query;
     final IAtomContainer target;

     // obtain only the mappings where the first atom in the query is
     // mapped to the first atom in the target
     Mappings mappings = Pattern.findSubstructure(query)
                                .matchAll(target)
                                .filter(new Predicate&lt;int[]&gt;() {
                                    public boolean apply(int[] input) {
                                        return input[0] == 0;
                                    }});

 </code></pre></blockquote></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>predicate</code> - a predicate</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>fluent-api reference</dd>
</dl>
</li>
</ul>
<a id="map(java.util.function.Function)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>map</h4>
<pre class="methodSignature">public&nbsp;&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;T&gt;&nbsp;map&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Function.html?is-external=true" title="class or interface in java.util.function" class="externalLink">Function</a>&lt;int[],&#8203;T&gt;&nbsp;f)</pre>
<div class="block">Map the mappings to another type. Each mapping is transformed using the
 provided function.

 <blockquote><pre><code>

     final IAtomContainer query;
     final IAtomContainer target;

     Mappings mappings = Pattern.findSubstructure(query)
                                .matchAll(target);

     // a string that indicates the mapping of atom elements and numbers
     Iterable&amp;lt;String&amp;gt; strs = mappings.map(new Function&lt;int[], String&gt;() {
         public String apply(int[] input) {
             StringBuilder sb = new StringBuilder();
             for (int i = 0; i &amp;lt; input.length; i++) {
                 if (i &gt; 0) sb.append(", ");
                 sb.append(query.getAtom(i))
                   .append(i + 1)
                   .append(" -&gt; ")
                   .append(target.getAtom(input[i]))
                   .append(input[i] + 1);
             }
             return sb.toString();
         }});

 </code></pre></blockquote></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>f</code> - function to transform a mapping</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>iterable of the transformed type</dd>
</dl>
</li>
</ul>
<a id="limit(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>limit</h4>
<pre class="methodSignature">public&nbsp;<a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a>&nbsp;limit&#8203;(int&nbsp;limit)</pre>
<div class="block">Limit the number of mappings - only this number of mappings will be
 generate.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>limit</code> - the number of mappings</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>fluent-api instance</dd>
</dl>
</li>
</ul>
<a id="stereochemistry()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stereochemistry</h4>
<pre class="methodSignature"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Deprecated.html?is-external=true" title="class or interface in java.lang" class="externalLink">@Deprecated</a>
public&nbsp;<a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a>&nbsp;stereochemistry()</pre>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Results now automatically consider stereo if it's present, to
             match without stereochemistry remove the stereo features.</div>
</div>
<div class="block">Filter the mappings for those which preserve stereochemistry specified in
 the query.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>fluent-api instance</dd>
</dl>
</li>
</ul>
<a id="uniqueAtoms()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>uniqueAtoms</h4>
<pre class="methodSignature">public&nbsp;<a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a>&nbsp;uniqueAtoms()</pre>
<div class="block">Filter the mappings for those which cover a unique atoms in the
 target. The unique atom mappings are a subset of the unique bond
 matches.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>fluent-api instance</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="#uniqueBonds()"><code>uniqueBonds()</code></a>, 
<a href="#exclusiveAtoms()"><code>exclusiveAtoms()</code></a></dd>
</dl>
</li>
</ul>
<a id="exclusiveAtoms()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>exclusiveAtoms</h4>
<pre class="methodSignature">public&nbsp;<a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a>&nbsp;exclusiveAtoms()</pre>
<div class="block">Filter the mappings for those which cover an exclusive set of atoms in
 the target. If a match overlaps with another one it is not returned. For
 example suppose we had the query <code>C~O</code> and matched against a
 carboxylic acid <code>*C(O)=O</code>, there are <b>2</b> unique matches but
 only <b>1</b> exclusive match. If we had two -CO2 groups
 (<code>c1ccc(C(O)=O)cc1C(O)=O</code> there are  unique matches and
 <code>2</code> exclusive matches.
 The exclusive atom mappings are therefore a subset of the unique atom
 matches.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>fluent-api instance</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="#uniqueAtoms()"><code>uniqueAtoms()</code></a>, 
<code>ExclusiveAtomMatches</code></dd>
</dl>
</li>
</ul>
<a id="uniqueBonds()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>uniqueBonds</h4>
<pre class="methodSignature">public&nbsp;<a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a>&nbsp;uniqueBonds()</pre>
<div class="block">Filter the mappings for those which cover a unique set of bonds in the
 target.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>fluent-api instance</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="#uniqueAtoms()"><code>uniqueAtoms()</code></a></dd>
</dl>
</li>
</ul>
<a id="toArray()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toArray</h4>
<pre class="methodSignature">public&nbsp;int[][]&nbsp;toArray()</pre>
<div class="block">Mappings are lazily generated and best used in a loop. However if all
 mappings are required this method can provide a fixed size array of
 mappings.

 <blockquote><pre>

 IAtomContainer query  = ...;
 IAtomContainer target = ...;

 Pattern pat = Pattern.findSubstructure(query);

 // lazily iterator
 for (int[] mapping : pat.matchAll(target)) {
     // logic...
 }

 int[][] mappings = pat.matchAll(target)
                       .toArray();

 // same as lazy iterator but we now can refer to and parse 'mappings'
 // to other methods without regenerating the graph match
 for (int[] mapping : mappings) {
     // logic...
 }
 </pre></blockquote>

 The method can be used in combination with other modifiers.

 <blockquote><pre>

 IAtomContainer query  = ...;
 IAtomContainer target = ...;

 Pattern pat = Pattern.findSubstructure(query);

 // array of the first 5 unique atom mappings
 int[][] mappings = pat.matchAll(target)
                       .uniqueAtoms()
                       .limit(5)
                       .toArray();
 </pre></blockquote></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>array of mappings</dd>
</dl>
</li>
</ul>
<a id="toAtomMap()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toAtomMap</h4>
<pre class="methodSignature">public&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util" class="externalLink">Map</a>&lt;<a href="../interfaces/IAtom.html" title="interface in org.openscience.cdk.interfaces">IAtom</a>,&#8203;<a href="../interfaces/IAtom.html" title="interface in org.openscience.cdk.interfaces">IAtom</a>&gt;&gt;&nbsp;toAtomMap()</pre>
<div class="block">Convert the permutations to a atom-atom map.

 <blockquote><pre>
 for (Map&lt;IAtom,IAtom&gt; map : mappings.toAtomMap()) {
     for (Map.Entry&lt;IAtom,IAtom&gt; e : map.entrySet()) {
         IAtom queryAtom  = e.getKey();
         IAtom targetAtom = e.getValue();
     }
 }
 </pre></blockquote></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>iterable of atom-atom mappings</dd>
</dl>
</li>
</ul>
<a id="toBondMap()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toBondMap</h4>
<pre class="methodSignature">public&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util" class="externalLink">Map</a>&lt;<a href="../interfaces/IBond.html" title="interface in org.openscience.cdk.interfaces">IBond</a>,&#8203;<a href="../interfaces/IBond.html" title="interface in org.openscience.cdk.interfaces">IBond</a>&gt;&gt;&nbsp;toBondMap()</pre>
<div class="block">Convert the permutations to a bond-bond map.

 <blockquote><pre>
 for (Map&lt;IBond,IBond&gt; map : mappings.toBondMap()) {
     for (Map.Entry&lt;IBond,IBond&gt; e : map.entrySet()) {
         IBond queryBond  = e.getKey();
         IBond targetBond = e.getValue();
     }
 }
 </pre></blockquote></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>iterable of bond-bond mappings</dd>
</dl>
</li>
</ul>
<a id="toAtomBondMap()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toAtomBondMap</h4>
<pre class="methodSignature">public&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util" class="externalLink">Map</a>&lt;<a href="../interfaces/IChemObject.html" title="interface in org.openscience.cdk.interfaces">IChemObject</a>,&#8203;<a href="../interfaces/IChemObject.html" title="interface in org.openscience.cdk.interfaces">IChemObject</a>&gt;&gt;&nbsp;toAtomBondMap()</pre>
<div class="block">Convert the permutations to an atom-atom bond-bond map.

 <blockquote><pre>
 for (Map&lt;IChemObject,IChemObject&gt; map : mappings.toBondMap()) {
     for (Map.Entry&lt;IChemObject,IChemObject&gt; e : map.entrySet()) {
         IChemObject queryObj  = e.getKey();
         IChemObject targetObj = e.getValue();
     }

     IAtom matchedAtom = map.get(query.getAtom(i));
     IBond matchedBond = map.get(query.getBond(i));
 }
 </pre></blockquote></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>iterable of atom-atom and bond-bond mappings</dd>
</dl>
</li>
</ul>
<a id="stream()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stream</h4>
<pre class="methodSignature">public&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html?is-external=true" title="class or interface in java.util.stream" class="externalLink">Stream</a>&lt;int[]&gt;&nbsp;stream()</pre>
<div class="block">Convert the Mappings to a Java 8 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html?is-external=true" title="class or interface in java.util.stream" class="externalLink"><code>Stream</code></a>. The Stream API was written after
 this class and provides much of the functionality (e.g. <a href="#map(java.util.function.Function)"><code>map(java.util.function.Function&lt;int[], T&gt;)</code></a> is <a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html?is-external=true#map(java.util.function.Function)" title="class or interface in java.util.stream" class="externalLink"><code>Stream.map(java.util.function.Function)</code></a> etc. Unlike an Iterable, a stream cannot be traversed more
 than once.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the stream</dd>
</dl>
</li>
</ul>
<a id="toChemObjects()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toChemObjects</h4>
<pre class="methodSignature">public&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;<a href="../interfaces/IChemObject.html" title="interface in org.openscience.cdk.interfaces">IChemObject</a>&gt;&nbsp;toChemObjects()</pre>
<div class="block">Obtain the chem objects (atoms and bonds) that have 'hit' in the target molecule.

 <blockquote><pre>
 for (IChemObject obj : mappings.toChemObjects()) {
   if (obj instanceof IAtom) {
      // this atom was 'hit' by the pattern
   }
 }
 </pre></blockquote></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>non-lazy iterable of chem objects</dd>
</dl>
</li>
</ul>
<a id="toSubstructuresStream()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toSubstructuresStream</h4>
<pre class="methodSignature">public&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html?is-external=true" title="class or interface in java.util.stream" class="externalLink">Stream</a>&lt;<a href="../interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</a>&gt;&nbsp;toSubstructuresStream()</pre>
<div class="block">Obtain the mapped substructures (atoms/bonds) of the target compound. The atoms
 and bonds are the same as in the target molecule but there may be less of them.

 <blockquote><pre>
 IAtomContainer query, target
 Mappings mappings = ...;
 for (IAtomContainer mol : mol.toSubstructures()) {
    for (IAtom atom : mol.atoms())
      target.contains(atom); // always true
    for (IAtom atom : target.atoms())
      mol.contains(atom): // not always true
 }
 </pre></blockquote></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>lazy stream iterable of molecules</dd>
</dl>
</li>
</ul>
<a id="toSubstructures()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toSubstructures</h4>
<pre class="methodSignature">public&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;<a href="../interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</a>&gt;&nbsp;toSubstructures()</pre>
<div class="block">Obtain the mapped substructures (atoms/bonds) of the target compound. The atoms
 and bonds are the same as in the target molecule but there may be less of them.

 <blockquote><pre>
 IAtomContainer query, target
 Mappings mappings = ...;
 for (IAtomContainer mol : mol.toSubstructures()) {
    for (IAtom atom : mol.atoms())
      target.contains(atom); // always true
    for (IAtom atom : target.atoms())
      mol.contains(atom): // not always true
 }
 </pre></blockquote></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>non-lazy iterable of molecules</dd>
</dl>
</li>
</ul>
<a id="atLeast(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>atLeast</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;atLeast&#8203;(int&nbsp;n)</pre>
<div class="block">Efficiently determine if there are at least 'n' matches

 <blockquote><pre>
 Mappings mappings = ...;

 if (mappings.atLeast(5))
    // set bit flag etc.

 // are the at least 5 unique matches?
 if (mappings.uniqueAtoms().atLeast(5))
    // set bit etc.
 </pre></blockquote></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>n</code> - number of matches</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>there are at least 'n' matches</dd>
</dl>
</li>
</ul>
<a id="first()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>first</h4>
<pre class="methodSignature">public&nbsp;int[]&nbsp;first()</pre>
<div class="block">Obtain the first match - if there is no first match an empty array is
 returned.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>first match</dd>
</dl>
</li>
</ul>
<a id="count()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>count</h4>
<pre class="methodSignature">public&nbsp;int&nbsp;count()</pre>
<div class="block">Convenience method to count the number mappings. Note mappings are lazily
 generated and checking the count and then iterating over the mappings
 currently performs two searches. If the mappings are also needed, it is
 more efficient to check the mappings and count manually.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>number of matches</dd>
</dl>
</li>
</ul>
<a id="countUnique()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>countUnique</h4>
<pre class="methodSignature">public&nbsp;int&nbsp;countUnique()</pre>
<div class="block">Convenience method to count the number of unique atom mappings. Note
 mappings are lazily generated and checking the count and then iterating
 over the mappings currently performs two searches. If the mappings are
 also needed, it is more efficient to check the mappings and count
 manually.

 The method is simply invokes <pre>mappings.uniqueAtoms().count()</pre>.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>number of matches</dd>
</dl>
</li>
</ul>
<a id="iterator()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>iterator</h4>
<pre class="methodSignature">public&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Iterator.html?is-external=true" title="class or interface in java.util" class="externalLink">Iterator</a>&lt;int[]&gt;&nbsp;iterator()</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true#iterator()" title="class or interface in java.lang" class="externalLink">iterator</a></code>&nbsp;in interface&nbsp;<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Iterable</a>&lt;int[]&gt;</code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Mappings.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &#169; 2025. All rights reserved.</small></p>
</footer>
</body>
</html>
